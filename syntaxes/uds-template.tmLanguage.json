{
  "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
  "name": "uds-template",
  "scopeName": "source.uds-template",
  "patterns": [
    { "include": "#comments-hash" },
    { "include": "#comments-hash-log" },
    { "include": "#comments-hash-header" },
    { "include": "#comments-semicolon" },
    { "include": "#canape-commands" },
    { "include": "#expected-ini-patterns" },
    { "include": "#keywords-values" },
    { "include": "#uds-service-values" },
    { "include": "#if-block" },
    { "include": "#lauterlbach-commands" }
  ],
  "repository": {
    "comments-hash": {
      "begin": "#(?!!|>#|>#>)",
      "end": "$",
      "name": "comment.line.hash.uds-template",
      "patterns": [
        { "include": "#expected-ini-patterns" },
        { "include": "#keywords-values" }
      ]
    },
    "comments-hash-log": {
      "begin": "#>+",
      "end": "$",
      "name": "comment.line.hash-log.uds-template",
      "patterns": [
        { "include": "#expected-ini-patterns" },
        { "include": "#keywords-values" }
      ]
    },
    "comments-hash-header": {
      "begin": "#>#+",
      "end": "$",
      "name": "comment.line.hash-header.uds-template",
      "patterns": [
          { "include": "#expected-ini-patterns" },
          { "include": "#keywords-values" }
      ]
    },
    "comments-semicolon": {
      "begin": ";(?!!)",
      "end": "$",
      "name": "comment.line.semicolon.uds-template",
      "patterns": [
        { "include": "#expected-ini-patterns" },
        { "include": "#keywords-values" }
      ]
    },
    "canape-commands": {
      "patterns": [
        {
          "name": "support.function.canape.uds-template",
          "match": "!\\b(prog|set|baud|activate|canalyzer|canid|sa|batch|auth|sleep|append)\\b(?=\\()"
        },
        { "include": "#keywords-values" }
      ]
    },
    "expected-ini-patterns": {
      "patterns": [
        {
          "name": "keyword.control.expected.uds-template",
          "match": "\\$\\b(EXPECTED)\\b(?=\\()"
        }
      ]
    },
    "keywords-values":{
        "patterns": [
        {
            "name": "keyword.other.ini-reference.uds-template",
            "match": "@\\([^)]*\\)"
        },
            {
            "name": "keyword.other.ini-postprocess.uds-template",
            "match": "\\$\\([^()]*\\)"
        }
        ]
            
    },
    "uds-service-values": {
      "patterns": [
        {
          "name": "constant.numeric.uds-service.uds-template",
          "match": "\\b(?:[0-9A-Fa-f]{2}|@\\([^()]+\\))(?:,(?:[0-9A-Fa-f]{2}|@\\([^()]+\\)))+(?=\\s)"
        },
        {
          "name": "constant.numeric.uds-service.uds-template",
          "match": "\\b(?:[0-9A-Fa-f]{2}){2,}(?=\\s)"
        },
        { "include": "#keywords-values" }
      ]
    },
    "if-block": {
      "begin": "^\\s*@IF\\b.*$",
      "beginCaptures": {
        "0": {
          "name": "keyword.control.conditional.if.uds-template"
        }
      },
      "end": "^\\s*@ENDIF\\b.*$",
      "endCaptures": {
        "0": {
          "name": "keyword.control.conditional.endif.uds-template"
        }
      },
      "patterns": [
        {
          "match": "^\\s*@ELIF\\b.*$",
          "name": "keyword.control.conditional.elif.uds-template"
        },
        {
          "match": "^\\s*@ELSE\\b.*$",
          "name": "keyword.control.conditional.else.uds-template"
        },
        { "include": "#comments-hash" },
        { "include": "#comments-hash-log" },
        { "include": "#comments-hash-header" },
        { "include": "#comments-semicolon" },
        { "include": "#canape-commands" },
        { "include": "#expected-ini-patterns" },
        { "include": "#keywords-values" },
        { "include": "#uds-service-values" },
        { "include": "#if-block" },
        { "include": "#lauterlbach-commands" }
      ]
    },
    "lauterbach-commands":{
      "patterns": [
        {
          "name": "support.function.lauterbach.uds-template",
          "match": "\\b(?:LOAD|RUN|BREAK|GO)\\b(?=\\()"
        },
        { "include": "#keywords-values" }
      ]
    }
  },
  "fileTypes": ["uds.template"],
  "uuid": "d0f1e432-7d39-11ee-b962-0242ac120002",
  "foldingStartMarker": "(?x)^\\s*@IF\\b",
  "foldingStopMarker": "(?x)^\\s*@ENDIF\\b"
}
